# Контекст проекта (Журнал сессии)

## Обзор проекта
- Проект: `aaag---alatau-advance-air-group`
- Стек: React + TypeScript + Vite + Tailwind (через плагин Vite), framer-motion, react-router-dom, react-leaflet.
- Основной языковой микс: контент RU/EN.

## Согласованные термины
- `безоп`: условное короткое название лендинга по безопасности (`/security`).
- `прикол`: изображение на переднем плане.
- `фоно`: изображение/графика на заднем плане.
- Уточнение по первому блоку `безоп`: `прикол` — это eVTOL, `фоно` — фоновая подложка/контурные линии за ним.
- Уточнение по второму блоку `безоп` (`#safety-architecture`): `прикол` — это текст и картинка вместе (единый визуальный фокус блока).
- Во втором блоке `безоп` текст и картинка объединены в единый логический блок `прикол` и должны перемещаться строго вместе.
- Текущее именование маршрутов:
  - Основной лендинг: `/main`
  - Лендинг по безопасности (`безоп`): `/security`
- Поддержка legacy-маршрутов, присутствующая сейчас:
  - `/` перенаправляет на `/main`
  - `/bezop` перенаправляет на `/security`

## Высокоуровневые работы, выполненные в этой сессии

### 1) Первичный аудит + критический отчет
- Проведен технический аудит структуры сайта, состояния сборки, доступности, маршрутизации и производительности.
- Создан `critical.md` с выводами и приоритетами.

### 2) Инфраструктура / сборка / стилизация
- Tailwind мигрирован с CDN в `index.html` в локальный пайплайн сборки через `@tailwindcss/vite`.
- Добавлен `index.css` и импортирован в `index.tsx`.
- Удалены `importmap` и устаревшая прямая ссылка на `/index.css` из `index.html`.
- Исправлено правило viewport (удален `user-scalable=0`).

### 3) Эволюция маршрутизации и навигации
- Добавлены дополнительные страницы для юридических ссылок:
  - `pages/PrivacyPage.tsx`
  - `pages/TermsPage.tsx`
- Маршрутизация обновлялась со временем; финальная конвенция теперь `/main` и `/security`.
- Добавлено fallback-поведение редиректа для SPA-хостинга через `public/404.html` и логика восстановления редиректа в `index.tsx`.
- Поведение навигации на `/security` настроено на локальные якоря секций (`#safety-top`, `#safety-architecture`, `#safety-scenarios`).

### 4) Работы по производительности
- Основные тяжелые ассеты `.png` конвертированы в `.webp`, импорты обновлены во всех компонентах/страницах.
- Добавлено ленивое разбиение на чанки на уровне маршрутов (`React.lazy` + `Suspense`) для более тяжелых страниц/компонентов.
- Снижен размер JS-бандла за счет переноса GeoJSON карты из JS-бандла (`?raw`) в runtime-fetch из `public/data`.
- Добавлено ручное разделение чанков в `vite.config.ts` для крупных вендоров.

### 5) Доступность / UX
- Заменены/удалены заглушечные ссылки `href="#"`.
- Улучшены семантика кнопок/ссылок и aria-метки в навигации.
- Исправлена логика прокрутки к началу для макетов с внутренним scroll-контейнером `main`.

### 6) Итерации блоков безопасности (Main + Security)
- Секция Safety на главной несколько раз выравнивалась под стиль первого блока Security.
- Добавлен, затем перерисован CTA (`Узнать больше`) с вариантами hover-анимации:
  - протестирован `offset`, затем выполнен переход на `slide`.
  - исправлен баг частичного заполнения путем реализации slide через overlay на псевдоэлементе.
- Добавлена кнопка `Назад на главную` на странице безопасности и проведены итерации ее целевого поведения.

### 7) Итерации страницы Security (Блок 2 / Блок 3)
- Выполнены множественные эксперименты с макетом по инструкциям пользователя:
  - редизайн блока 2 с карточками и анимацией,
  - откат к более простой форме,
  - многократные сдвиги текста/изображения вправо/вверх,
  - временный перенос контента блока 3 в блок 2,
  - откат к раздельному состоянию блока 2 и блока 3,
  - дальнейшие микро-корректировки позиционирования.
- Текущее состояние UI отражает последние пользовательские правки позиций (сдвинутые вправо изображение/текст в блоке 2).
- Последнее уточнение: во втором блоке `прикол` трактуется как связка «текст + картинка», и сдвиги применяются к обоим элементам.
- Техническая фиксация: во втором блоке `прикол` реализован общим контейнером (общий translate), чтобы исключить рассинхрон текст/картинка.

## Важные события / заметки сессии
- В один из моментов `components/Safety.tsx` был случайно обрезан командой замены в shell и сразу восстановлен.
- Пользователь явно запросил строгие инкрементальные изменения на позднем этапе ("делай только то, что я прошу").
- Несколько запросов были намеренно итеративными и визуальными (настройка позиции повторяющимися командами "выше/правее").

## Файлы, затронутые в ходе сессии (ключевые)
- `critical.md`
- `context.md` (этот файл)
- `index.html`
- `index.tsx`
- `index.css`
- `vite.config.ts`
- `App.tsx`
- `components/Navigation.tsx`
- `components/Safety.tsx`
- `components/Hero.tsx`
- `components/Footer.tsx`
- `components/RoutesMap.tsx`
- `pages/SafetyPage.tsx`
- `pages/PrivacyPage.tsx`
- `pages/TermsPage.tsx`
- `public/404.html`
- `public/data/almaty-boundary.geojson`
- `public/data/almaty-roads.geojson`

## Текущие рабочие конвенции
- "безоп" означает лендинг по безопасности (`/security`).
- "прикол" — передний план; "фоно" — задний план.
- В первом блоке `безоп`: `прикол` = eVTOL, `фоно` = подложка/контурный фон.
- Во втором блоке `безоп`: `прикол` = текст + картинка вместе.
- Во втором блоке `безоп` перемещение выполняется только для общего контейнера `прикол` (не раздельно по элементам).
- Основной лендинг: `/main`.
- Пользователь предпочитает точные, пошаговые визуальные изменения без дополнительных непрошенных правок.
- Для тюнинга макета пользователь дает прямые относительные команды ("выше", "правее" и т.д.) и ожидает немедленной микро-корректировки.

## Ожидаемое намерение пользователя (самое недавнее)
- Продолжить точное позиционирование и выравнивание дизайна для блока 2/3 на `/security` согласно указаниям в следующих шагах.
